{\rtf1\ansi\ansicpg1252\cocoartf2580
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica;}
{\colortbl;\red255\green255\blue255;}
{\*\expandedcolortbl;;}
\paperw11900\paperh16840\margl1440\margr1440\vieww37900\viewh20740\viewkind0
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0

\f0\fs24 \cf0 /* THIS IS A SINGLE LINE COMMENT \
THIS IS A MULTI LINE COMMENT.\
IT CAN GO MULTIPLE LINES\
THUS ENHANCES CODE READIBILITY  */\
\
\
CREATE DATABASE AJ_SQL_DEMO_DATABASE_YT;\
USE DATABASE AJ_SQL_DEMO_DATABASE;\
DROP DATABASE AJ_SQL_DEMO_DATABASE;\
\
\
USE DATABASE AJ_SQL_DEMO_DATABASE_NEW;

ALTER database "SNOWFLAKE_SAMPLE_DAT" RENAME TO "SNOWFLAKE_SAMPLE_DATA";

select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF100TCL"."CUSTOMER" LIMIT 1000;\
SHOW COLUMNS IN "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF100TCL"."STORE";\
\
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF100TCL"."CUSTOMER" limit 100;\
\
SELECT COUNT(*) FROM  "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF100TCL"."CUSTOMER";\
SELECT DISTINCT * FROM  "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF100TCL"."CUSTOMER";\
\
SELECT * FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF100TCL"."CUSTOMER" LIMIT 1000;\
\
SHOW COLUMNS IN "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF100TCL"."STORE";\
\
SELECT * FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF100TCL"."ITEM" LIMIT 30;\
\
SELECT * FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF100TCL"."CUSTOMER" WHERE C_FIRST_NAME = 'Joseph';\
\
SELECT * FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF100TCL"."CUSTOMER" WHERE (C_BIRTH_YEAR = 1973 AND C_BIRTH_MONTH = 9);\
\
### TELL ME THE DETAILS OF ALL C_CUSTOMER_SK WHO WAS BORIN IN YEAR 1973,2003,1990,1945 AND IN THE 8TH MONTH AND HAVING EMAIL ID AND LAST NAME\
\
SELECT DISTINCT C_BIRTH_YEAR FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF100TCL"."CUSTOMER";
\
SELECT TRUNC(TO_DATE('13-AUG-22','DD-MON-YY'), 'YEAR')
  "SQL DATE TRUNC CLASS" FROM DUAL;


USE DATABASE "AJ_SQL_DEMO_DATABASE_YT";

CREATE TABLE  "AGENTS" 
   (	
    "AGENT_CODE" CHAR(6) NOT NULL PRIMARY KEY, 
	"AGENT_NAME" CHAR(40), 
	"WORKING_AREA" CHAR(35), 
	"COMMISSION" NUMBER(10,2) DEFAULT 0.05, 
	"PHONE_NO" CHAR(15), 
	"COUNTRY" VARCHAR2(25) 
	 );

INSERT INTO AGENTS VALUES ('A007', 'Ramasundar', 'Bangalore', '0.15', '077-25814763', '');
INSERT  INTO AGENTS VALUES ('A003', 'Alex ', 'London', '0.13', '075-12458969', '');
INSERT INTO AGENTS VALUES ('A008', 'Alford', 'New York', '0.12', '044-25874365', '');
INSERT INTO AGENTS VALUES ('A011', 'Ravi Kumar', 'Bangalore', '0.15', '077-45625874', '');
INSERT INTO AGENTS VALUES ('A010', 'Santakumar', 'Chennai', '0.14', '007-22388644', '');
INSERT INTO AGENTS VALUES ('A012', 'Lucida', 'San Jose', '0.12', '044-52981425', '');
INSERT INTO AGENTS VALUES ('A005', 'Anderson', 'Brisban', '0.13', '045-21447739', '');
INSERT INTO AGENTS VALUES ('A001', 'Subbarao', 'Bangalore', '0.14', '077-12346674', '');
INSERT INTO AGENTS VALUES ('A002', 'Mukesh', 'Mumbai', '0.11', '029-12358964', '');
INSERT INTO AGENTS VALUES ('A006', 'McDen', 'London', '0.15', '078-22255588', '');
INSERT INTO AGENTS VALUES ('A004', 'Ivan', 'Torento', '0.15', '008-22544166', '');
INSERT INTO AGENTS VALUES ('A009', 'Benjamin', 'Hampshair', '0.11', '008-22536178', '');

SELECT * FROM AGENTS;

UPDATE  AGENTS

SET COUNTRY = 'IND'

WHERE AGENT_CODE = 'A010';

ALTER TABLE AGENTS

ALTER COLUMN PHONE_NO NOT NULL;

ALTER TABLE AGENTS

DROP COLUMN COUNTRY;


ALTER TABLE AGENTS
ADD EMAIL VARCHAR(100)

--- NUMBER OF AGENTS IN EACH WORKING AREA\
SELECT WORKING_AREA,COUNT(DISTINCT AGENT_CODE) AS AGENTS_WORKING_AREA\
FROM AGENTS\
GROUP BY 1\
ORDER BY 1 ;\
\
DESC TABLE AGENTS;\
SHOW COLUMNS IN AGENTS;\
\
\
CREATE TABLE  "CUSTOMER" \
   (	\
    "CUST_CODE" VARCHAR2(6) NOT NULL PRIMARY KEY, \
	"CUST_NAME" VARCHAR2(40) NOT NULL, \
	"CUST_CITY" CHAR(35), \
	"WORKING_AREA" VARCHAR2(35) NOT NULL, \
	"CUST_COUNTRY" VARCHAR2(20) NOT NULL, \
	"GRADE" NUMBER, \
	"OPENING_AMT" NUMBER(12,2) NOT NULL, \
	"RECEIVE_AMT" NUMBER(12,2) NOT NULL, \
	"PAYMENT_AMT" NUMBER(12,2) NOT NULL, \
	"OUTSTANDING_AMT" NUMBER(12,2) NOT NULL, \
	"PHONE_NO" VARCHAR2(17) NOT NULL, \
	"AGENT_CODE" CHAR(6) NOT NULL REFERENCES AGENTS\
);   \
\
INSERT INTO CUSTOMER VALUES ('C00013', 'Holmes', 'London', 'London', 'UK', '2', '6000.00', '5000.00', '7000.00', '4000.00', 'BBBBBBB', 'A003');\
INSERT INTO CUSTOMER VALUES ('C00001', 'Micheal', 'New York', 'New York', 'USA', '2', '3000.00', '5000.00', '2000.00', '6000.00', 'CCCCCCC', 'A008');\
INSERT INTO CUSTOMER VALUES ('C00020', 'Albert', 'New York', 'New York', 'USA', '3', '5000.00', '7000.00', '6000.00', '6000.00', 'BBBBSBB', 'A008');\
INSERT INTO CUSTOMER VALUES ('C00025', 'Ravindran', 'Bangalore', 'Bangalore', 'India', '2', '5000.00', '7000.00', '4000.00', '8000.00', 'AVAVAVA', 'A011');\
INSERT INTO CUSTOMER VALUES ('C00024', 'Cook', 'London', 'London', 'UK', '2', '4000.00', '9000.00', '7000.00', '6000.00', 'FSDDSDF', 'A006');\
INSERT INTO CUSTOMER VALUES ('C00015', 'Stuart', 'London', 'London', 'UK', '1', '6000.00', '8000.00', '3000.00', '11000.00', 'GFSGERS', 'A003');\
INSERT INTO CUSTOMER VALUES ('C00002', 'Bolt', 'New York', 'New York', 'USA', '3', '5000.00', '7000.00', '9000.00', '3000.00', 'DDNRDRH', 'A008');\
INSERT INTO CUSTOMER VALUES ('C00018', 'Fleming', 'Brisban', 'Brisban', 'Australia', '2', '7000.00', '7000.00', '9000.00', '5000.00', 'NHBGVFC', 'A005');\
INSERT INTO CUSTOMER VALUES ('C00021', 'Jacks', 'Brisban', 'Brisban', 'Australia', '1', '7000.00', '7000.00', '7000.00', '7000.00', 'WERTGDF', 'A005');\
INSERT INTO CUSTOMER VALUES ('C00019', 'Yearannaidu', 'Chennai', 'Chennai', 'India', '1', '8000.00', '7000.00', '7000.00', '8000.00', 'ZZZZBFV', 'A010');\
INSERT INTO CUSTOMER VALUES ('C00005', 'Sasikant', 'Mumbai', 'Mumbai', 'India', '1', '7000.00', '11000.00', '7000.00', '11000.00', '147-25896312', 'A002');\
INSERT INTO CUSTOMER VALUES ('C00007', 'Ramanathan', 'Chennai', 'Chennai', 'India', '1', '7000.00', '11000.00', '9000.00', '9000.00', 'GHRDWSD', 'A010');\
INSERT INTO CUSTOMER VALUES ('C00022', 'Avinash', 'Mumbai', 'Mumbai', 'India', '2', '7000.00', '11000.00', '9000.00', '9000.00', '113-12345678','A002');\
INSERT INTO CUSTOMER VALUES ('C00004', 'Winston', 'Brisban', 'Brisban', 'Australia', '1', '5000.00', '8000.00', '7000.00', '6000.00', 'AAAAAAA', 'A005');\
INSERT INTO CUSTOMER VALUES ('C00023', 'Karl', 'London', 'London', 'UK', '0', '4000.00', '6000.00', '7000.00', '3000.00', 'AAAABAA', 'A006');\
INSERT INTO CUSTOMER VALUES ('C00006', 'Shilton', 'Torento', 'Torento', 'Canada', '1', '10000.00', '7000.00', '6000.00', '11000.00', 'DDDDDDD', 'A004');\
INSERT INTO CUSTOMER VALUES ('C00010', 'Charles', 'Hampshair', 'Hampshair', 'UK', '3', '6000.00', '4000.00', '5000.00', '5000.00', 'MMMMMMM', 'A009');\
INSERT INTO CUSTOMER VALUES ('C00017', 'Srinivas', 'Bangalore', 'Bangalore', 'India', '2', '8000.00', '4000.00', '3000.00', '9000.00', 'AAAAAAB', 'A007');\
INSERT INTO CUSTOMER VALUES ('C00012', 'Steven', 'San Jose', 'San Jose', 'USA', '1', '5000.00', '7000.00', '9000.00', '3000.00', 'KRFYGJK', 'A012');\
INSERT INTO CUSTOMER VALUES ('C00008', 'Karolina', 'Torento', 'Torento', 'Canada', '1', '7000.00', '7000.00', '9000.00', '5000.00', 'HJKORED', 'A004');\
INSERT INTO CUSTOMER VALUES ('C00003', 'Martin', 'Torento', 'Torento', 'Canada', '2', '8000.00', '7000.00', '7000.00', '8000.00', 'MJYURFD', 'A004');\
INSERT INTO CUSTOMER VALUES ('C00009', 'Ramesh', 'Mumbai', 'Mumbai', 'India', '3', '8000.00', '7000.00', '3000.00', '12000.00', 'Phone No', 'A002');\
INSERT INTO CUSTOMER VALUES ('C00014', 'Rangarappa', 'Bangalore', 'Bangalore', 'India', '2', '8000.00', '11000.00', '7000.00', '12000.00', 'AAAATGF', 'A001');\
INSERT INTO CUSTOMER VALUES ('C00016', 'Venkatpati', 'Bangalore', 'Bangalore', 'India', '2', '8000.00', '11000.00', '7000.00', '12000.00', 'JRTVFDD', 'A007');\
INSERT INTO CUSTOMER VALUES ('C00011', 'Sundariya', 'Chennai', 'Chennai', 'India', '3', '7000.00', '11000.00', '7000.00', '11000.00', 'PPHGRTS', 'A010');\
\
SELECT * FROM CUSTOMER;\
\
CREATE TABLE  "ORDERS" \
   (\
    "ORD_NUM" NUMBER(6,0) NOT NULL PRIMARY KEY, \
	"ORD_AMOUNT" NUMBER(12,2) NOT NULL, \
	"ADVANCE_AMOUNT" NUMBER(12,2) NOT NULL, \
	"ORD_DATE" DATE NOT NULL, \
	"CUST_CODE" VARCHAR2(6) NOT NULL REFERENCES CUSTOMER, \
	"AGENT_CODE" CHAR(6) NOT NULL REFERENCES AGENTS, \
	"ORD_DESCRIPTION" VARCHAR2(60) NOT NULL\
   );\
\
INSERT INTO ORDERS VALUES('200100', '1000.00', '600.00', '08/01/2008', 'C00013', 'A003', 'SOD');\
INSERT INTO ORDERS VALUES('200110', '3000.00', '500.00', '04/15/2008', 'C00019', 'A010', 'SOD');\
INSERT INTO ORDERS VALUES('200107', '4500.00', '900.00', '08/30/2008', 'C00007', 'A010', 'SOD');\
INSERT INTO ORDERS VALUES('200112', '2000.00', '400.00', '05/30/2008', 'C00016', 'A007', 'SOD'); \
INSERT INTO ORDERS VALUES('200113', '4000.00', '600.00', '06/10/2008', 'C00022', 'A002', 'SOD');\
INSERT INTO ORDERS VALUES('200102', '2000.00', '300.00', '05/25/2008', 'C00012', 'A012', 'SOD');\
INSERT INTO ORDERS VALUES('200114', '3500.00', '2000.00', '08/15/2008', 'C00002', 'A008', 'SOD');\
INSERT INTO ORDERS VALUES('200122', '2500.00', '400.00', '09/16/2008', 'C00003', 'A004', 'SOD');\
INSERT INTO ORDERS VALUES('200118', '500.00', '100.00', '07/20/2008', 'C00023', 'A006', 'SOD');\
INSERT INTO ORDERS VALUES('200119', '4000.00', '700.00', '09/16/2008', 'C00007', 'A010', 'SOD');\
INSERT INTO ORDERS VALUES('200121', '1500.00', '600.00', '09/23/2008', 'C00008', 'A004', 'SOD');\
INSERT INTO ORDERS VALUES('200130', '2500.00', '400.00', '07/30/2008', 'C00025', 'A011', 'SOD');\
INSERT INTO ORDERS VALUES('200134', '4200.00', '1800.00', '09/25/2008', 'C00004', 'A005', 'SOD');\
INSERT INTO ORDERS VALUES('200108', '4000.00', '600.00', '02/15/2008', 'C00008', 'A004', 'SOD');\
INSERT INTO ORDERS VALUES('200103', '1500.00', '700.00', '05/15/2008', 'C00021', 'A005', 'SOD');\
INSERT INTO ORDERS VALUES('200105', '2500.00', '500.00', '07/18/2008', 'C00025', 'A011', 'SOD');\
INSERT INTO ORDERS VALUES('200109', '3500.00', '800.00', '07/30/2008', 'C00011', 'A010', 'SOD');\
INSERT INTO ORDERS VALUES('200101', '3000.00', '1000.00', '07/15/2008', 'C00001', 'A008', 'SOD');\
INSERT INTO ORDERS VALUES('200111', '1000.00', '300.00', '07/10/2008', 'C00020', 'A008', 'SOD');\
INSERT INTO ORDERS VALUES('200104', '1500.00', '500.00', '03/13/2008', 'C00006', 'A004', 'SOD');\
INSERT INTO ORDERS VALUES('200106', '2500.00', '700.00', '04/20/2008', 'C00005', 'A002', 'SOD');\
INSERT INTO ORDERS VALUES('200125', '2000.00', '600.00', '10/10/2008', 'C00018', 'A005', 'SOD');\
INSERT INTO ORDERS VALUES('200117', '800.00', '200.00', '10/20/2008', 'C00014', 'A001', 'SOD');\
INSERT INTO ORDERS VALUES('200123', '500.00', '100.00', '09/16/2008', 'C00022', 'A002', 'SOD');\
INSERT INTO ORDERS VALUES('200120', '500.00', '100.00', '07/20/2008', 'C00009', 'A002', 'SOD');\
INSERT INTO ORDERS VALUES('200116', '500.00', '100.00', '07/13/2008', 'C00010', 'A009', 'SOD');\
INSERT INTO ORDERS VALUES('200124', '500.00', '100.00', '06/20/2008', 'C00017', 'A007', 'SOD'); \
INSERT INTO ORDERS VALUES('200126', '500.00', '100.00', '06/24/2008', 'C00022', 'A002', 'SOD');\
INSERT INTO ORDERS VALUES('200129', '2500.00', '500.00', '07/20/2008', 'C00024', 'A006', 'SOD');\
INSERT INTO ORDERS VALUES('200127', '2500.00', '400.00', '07/20/2008', 'C00015', 'A003', 'SOD');\
INSERT INTO ORDERS VALUES('200128', '3500.00', '1500.00', '07/20/2008', 'C00009', 'A002', 'SOD');\
INSERT INTO ORDERS VALUES('200135', '2000.00', '800.00', '09/16/2008', 'C00007', 'A010', 'SOD');\
INSERT INTO ORDERS VALUES('200131', '900.00', '150.00', '08/26/2008', 'C00012', 'A012', 'SOD');\
INSERT INTO ORDERS VALUES('200133', '1200.00', '400.00', '06/29/2008', 'C00009', 'A002', 'SOD');\
\
SELECT * FROM ORDERS;\
\
SHOW COLUMNS IN ORDERS;\
\
SELECT LEN('ANAND') AS TOT_CHAR ;\
\
-- SUBSTRING(string, start, length)\
SELECT SUBSTRING('ANANDJHA_1990@YAHOO.COM',-9,9) AS LEN_SUB_STRING;\
\
--LTRIM/RTRIM AS left and right trimto remove spaces from beginning or \
SELECT LEN(LTRIM('      ANAND JHA')) AS LEFT_TRIMMED_STRING;\
SELECT LEN('      ANAND JHA') AS LEFT_TRIMMED_STRING;\
\
SELECT RTRIM('ANAND JHA        ') AS RIGHT_TRIMMED_STRING;\
\
-- REPLACE() FUNCTION --\
--REPLACE(string,old_string,new_string)\
SELECT REPLACE('SQL CLASSES',' ','-') AS REPLACED_STRING;\
\
--LOWERCASE/UPPERCASE IN SQL\
SELECT UPPER('Kamal') as upper_name;\
SELECT LOWER('KAMAL') as lower_name;\
\
--INNER JOIN FOR CUSTOMERS & THEIR ORDER\
CREATE OR REPLACE TABLE CUST_ORDER_MASTER_TABLE_INNER_JOIN AS\
SELECT cust.*,ord_num,ORD_AMOUNT,ADVANCE_AMOUNT,ORD_DATE,ORD_DESCRIPTION,agent_name,agt.phone_no AS agt_phone,commission\
--cust.*,odr.*\
FROM CUSTOMER cust\
INNER JOIN ORDERS odr ON cust. CUST_CODE = odr.CUST_CODE\
INNER JOIN AGENTS agt ON cust.AGENT_CODE = agt.AGENT_CODE ;\
\
\
SELECT * FROM CUST_ORDER_MASTER_TABLE_INNER_JOIN;\
select count(distinct cust_code) from CUST_ORDER_MASTER_TABLE_INNER_JOIN; --25 distinct customer\
select count(distinct cust_name) from CUST_ORDER_MASTER_TABLE_INNER_JOIN; --25 distinct customer\
select count(distinct agent_name) from CUST_ORDER_MASTER_TABLE_INNER_JOIN; --12 distinct agents\
\
--- how many cust each agent has served\
SELECT AGENT_NAME,COUNT(DISTINCT CUST_CODE) AS CUST_SERVED\
FROM CUST_ORDER_MASTER_TABLE_INNER_JOIN\
GROUP BY 1\
ORDER BY 1;\
\
------ LEFT JOIN USE CASEE\
--INNER JOIN FOR CUSTOMERS & THEIR ORDER\
CREATE OR REPLACE TABLE CUST_ORDER_MASTER_TABLE_LEFT_JOIN AS\
SELECT cust.*,ord_num,ORD_AMOUNT,ADVANCE_AMOUNT,ORD_DATE,ORD_DESCRIPTION,agent_name,agt.phone_no AS agt_phone,commission\
--cust.*,odr.*\
FROM CUSTOMER cust\
LEFT JOIN ORDERS odr ON cust. CUST_CODE = odr.CUST_CODE\
LEFT JOIN AGENTS agt ON cust.AGENT_CODE = agt.AGENT_CODE ;\
\
\
SELECT * FROM CUST_ORDER_MASTER_TABLE_LEFT_JOIN;\
select count(distinct cust_code) from CUST_ORDER_MASTER_TABLE_INNER_JOIN; --25 distinct customer\
select count(distinct cust_name) from CUST_ORDER_MASTER_TABLE_INNER_JOIN; --25 distinct customer\
select count(distinct agent_name) from CUST_ORDER_MASTER_TABLE_INNER_JOIN; --12 distinct agents\
\
--- how many cust each agent has served\
SELECT AGENT_NAME,COUNT(DISTINCT CUST_CODE) AS CUST_SERVED\
FROM CUST_ORDER_MASTER_TABLE_INNER_JOIN\
GROUP BY 1\
ORDER BY 1;\
\
\
\
USE DATABASE "DEMODATABASE";\
\
CREATE OR REPLACE TABLE AJ_WOMENS_CLOTHING_DATASET \
(\
  ROW_NUM INT,\
  CLOTHING_ID INT PRIMARY KEY,\
  AGE INT,\
  TITLE VARCHAR(100),\
  REVIEW_TEXT VARCHAR(1000),\
  RATING INT,\
  RECOMMENDED_IND BOOLEAN,\
  POS_FEEDBACK_COUNT INT,\
  DIVISION_NAME STRING,\
  DEPARTMENT_NAME STRING,\
  CLASS_NAME STRING\
);  \
\
-- SUBSTRING(string, start, length)\
SELECT SUBSTRING('ANAND KUMAR JHA',3,2);\
\
\
---SALARY BUCKET CREATION USING CASE STATMENT\
\
SELECT *,\
CASE\
    WHEN SALARY >= 10000 AND SALARY <= 20000 THEN '10k-20k-Sal'\
    WHEN SALARY > 20000 AND SALARY <= 30000 THEN '20k-30k-Sal'\
    WHEN SALARY > 30000 AND SALARY <= 40000 THEN '30k-40k-Sal'\
    ELSE 'Beond40kSal'\
END AS SALARY_BUCKET    \
FROM "AJ_SQL_DEMO_DATABASE_NEW"."PUBLIC"."ANAND";
