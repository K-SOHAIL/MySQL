CREATE DATABASE AJ_DEMODATABASE

USE DATABASE AJ_DEMODATABASE

USE DATABASE DEMODATABASE;

DROP TABLE ANANDJHA_CONSUMER_COMPLAINTS


   
CREATE DATABASE PETS_OWNERS

USE DATABASE PETS_OWNERS

CREATE OR REPLACE TABLE KS_OWNER
(
   OwnerID INTEGER NOT NULL PRIMARY KEY ,
   Name VARCHAR2(20),
   Surname STRING,
   StreetAddress VARCHAR2(50),
   City STRING,
   State CHAR(4),
   StateFull STRING,
   ZipCode INTEGER
);

CREATE OR REPLACE TABLE KS_PETS
(
    PetID VARCHAR(10) NOT NULL PRIMARY KEY,
    Name VARCHAR(20),
    Kind STRING,
    Gender CHAR(7),
    Age INTEGER,
    OwnerID INTEGER NOT NULL REFERENCES KS_OWNER 
);

SELECT * FROM KS_OWNER
SELECT * FROM KS_PETS

--SUBQUERY
SELECT * FROM KS_OWNER WHERE OWNERID IN (SELECT DISTINCT OWNERID FROM KS_PETS);

SELECT NAME,SURNAME FROM KS_OWNER WHERE OWNERID NOT IN (SELECT DISTINCT OWNERID FROM KS_PETS WHERE KIND = 'Dog');




-- UNION ALL
SELECT OWNERID,NAME FROM KS_OWNER
UNION ALL
SELECT OWNERID,NAME FROM KS_PETS;

--EXCEPT CLAUSE
SELECT OWNERID,NAME FROM KS_OWNER
EXCEPT
SELECT OWNERID,NAME FROM KS_PETS;

--INTERSECT
SELECT OWNERID,NAME FROM KS_OWNER
INTERSECT
SELECT OWNERID,NAME FROM KS_PETS;

SELECT COUNT(DISTINCT OwnerID) from KS_OWNER;
SELECT COUNT(DISTINCT PetID) from KS_PETS;

-- NEED THE NAME OF OWNER & THEIR DOGS NAME ALONG WITH THEIR AGE  ---- INNER JOIN
SELECT O.Name AS OWNER_NAME,p.NAME AS PET_NAME,p.age AS PET_AGE
FROM KS_OWNER o
INNER JOIN KS_PETS p ON o.OwnerID = p.OwnerID;

--NEED THE NAME OF ALL THE OWNERS IRRESPECTIVE WETHER OR NOT THEY ARE HAVING PETS 
SELECT O.Name AS OWNER_NAME,p.NAME AS PET_NAME,p.age AS PET_AGE
FROM KS_OWNER o
LEFT OUTER JOIN KS_PETS p ON o.OwnerID = p.OwnerID;

--- COUNT OF PETS EACH OWNER HAS
SELECT O.Name AS OWNER_NAME,COUNT(DISTINCT p.PETID)
FROM KS_OWNER o
INNER JOIN KS_PETS p ON o.OwnerID = p.OwnerID
GROUP BY 1
ORDER BY 2 DESC;

---RIGHT JOIN
SELECT O.Name AS OWNER_NAME,p.NAME AS PET_NAME,p.age AS PET_AGE
FROM KS_OWNER o
RIGHT JOIN KS_PETS p ON o.OwnerID = p.OwnerID;

--FULL OUTER JOIN
SELECT O.*,P.*
FROM KS_OWNER O
FULL OUTER JOIN KS_PETS p ON o.OwnerID = p.OwnerID;

-- INFO OF ALL THE PETS HOLD BY THEIR OWNER
SELECT DISTINCT KIND FROM KS_PETS;
SELECT KIND,COUNT(*) FROM KS_PETS
GROUP BY 1;

--- CROSS JOIN 
SELECT O.*,P.*
FROM KS_OWNER O
CROSS JOIN KS_PETS p ;


